<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Rain Sugar BangBang Front-End</title><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="nextjs에 react responsive 적용하기"/><meta name="keywords" content="nextjs, nextjs-nextjs react responsive"/><meta http-equiv="subject" content="nextjs"/><meta property="og:title" content="nextjs react responsive"/><meta property="og:description" content="nextjs에 react responsive 적용하기"/><meta property="og:image" content="../images/NEXTJS.png"/><meta name="naver-site-verification" content="af9c8049662a7c6c85ea946e9eb561086e70062c"/><meta name="google-site-verification" content="Zgp7rA3RAdcRnhPPsGLK-t4KVTO86AejlDIQQIGpvLg"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4077287316160146" crossorigin="anonymous"></script><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="13"/><link rel="preload" href="/_next/static/css/b4f97ab2e5eec96e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b4f97ab2e5eec96e.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-f164db4954bac6ec.js" defer=""></script><script src="/_next/static/chunks/framework-73b8966a3c579ab0.js" defer=""></script><script src="/_next/static/chunks/main-b0c8bcfd40968c52.js" defer=""></script><script src="/_next/static/chunks/pages/_app-882c6320043e5869.js" defer=""></script><script src="/_next/static/chunks/572-f075c46b792eab08.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-2ebdf03b2b9521c0.js" defer=""></script><script src="/_next/static/QopKNQVYuIv1AsUZhOp4w/_buildManifest.js" defer=""></script><script src="/_next/static/QopKNQVYuIv1AsUZhOp4w/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="sc-e301a42a-0 hHncwW"><h1><a href="/">Rain Sugar BangBang</a></h1></header><div class="sc-ba37e1ab-0 jsuXVA"><section class="sc-ba37e1ab-1 flRwaC"><aside class="sc-66bc730f-0 khiCBg"><div class="sc-66bc730f-1 IEUha"><img alt="profile" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" style="color:transparent" src="https://avatars.githubusercontent.com/u/85297720?v=4"/><p>Hanbbi</p></div><div class="sc-66bc730f-2 irHvHG"><a target="_blank" href="https://github.com/LEE-YO-HAN"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0 0 68.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"></path></svg><span>yhl0078@gmail.com</span></a><a target="_blank" href="https://github.com/LEE-YO-HAN"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg><span>Github</span></a></div></aside><article class="sc-ba37e1ab-2 kOvCyN"><main class="sc-b1521f6d-0 gZBrfW"><section class="sc-b1521f6d-1 dITxBi"><p>nextjs</p><h1>nextjs에 react responsive 적용하기</h1><span>2023-03-04</span></section><main class="sc-b1521f6d-2 kyUxSa"><div class="markdown"><h3>이번에 새로 만들고 있는 토이 프로젝트를 작업하던 중, 모바일 화면일때만 화면을 보여주고 싶었다. 단, 모든 컴포넌트에 미디어쿼리를 통해 작성해줄 수는 없기에 react-responsive를 적용해 화면이 481px을 넘어가면 고정된 페이지를 보여줄 수 있도록 코드를 작성했다.</h3>
<h2>react-responsive 설치</h2>
<pre><pre node="[object Object]" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-bash" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#ffc66d">yarn</span><span> </span><span class="token" style="color:#ffc66d">add</span><span> react-responsive</span></code></pre></pre>
<h2>hook 설정</h2>
<pre><pre node="[object Object]" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-typescript" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// hook</span><span>
</span><span></span><span class="token" style="color:#808080">// useMideaQuery.tsx</span><span>
</span><span></span><span class="token module" style="color:#cc7832">export</span><span> </span><span class="token" style="color:#cc7832">const</span><span> </span><span class="token function-variable maybe-class-name" style="color:#ffc66d">Desktop</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">{</span><span> children </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token" style="color:#e8bf6a">any</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>  </span><span class="token" style="color:#cc7832">const</span><span> isDesktop </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#ffc66d">useMediaQuery</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>    minWidth</span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token" style="color:#6897bb">481</span><span class="token" style="color:#a9b7c6">,</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>  </span><span class="token control-flow" style="color:#cc7832">return</span><span> isDesktop </span><span class="token" style="color:#a9b7c6">?</span><span> children </span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token null nil" style="color:#cc7832">null</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span><span>
</span>
<span></span><span class="token module" style="color:#cc7832">export</span><span> </span><span class="token" style="color:#cc7832">const</span><span> </span><span class="token function-variable maybe-class-name" style="color:#ffc66d">Mobile</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">{</span><span> children </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token" style="color:#e8bf6a">any</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>  </span><span class="token" style="color:#cc7832">const</span><span> isMobile </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#ffc66d">useMediaQuery</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>    minWidth</span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token" style="color:#6897bb">481</span><span class="token" style="color:#a9b7c6">,</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>  </span><span class="token control-flow" style="color:#cc7832">return</span><span> </span><span class="token maybe-class-name">Mobile</span><span> </span><span class="token" style="color:#a9b7c6">?</span><span> children </span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token null nil" style="color:#cc7832">null</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span></code></pre></pre>
<h2>_app.ts 적용</h2>
<pre><pre node="[object Object]" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-typescript" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// _app.tsx</span><span>
</span>
<span></span><span class="token" style="color:#808080">// ...</span><span>
</span><span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports" style="color:#a9b7c6">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Mobile</span><span class="token imports"> </span><span class="token imports" style="color:#a9b7c6">}</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&quot;src/hooks/useMideaQuery&quot;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports" style="color:#a9b7c6">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">CannotDesktop</span><span class="token imports"> </span><span class="token imports" style="color:#a9b7c6">}</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&quot;src/desktop/CannotDesktop&quot;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span>
<span></span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">Mobile</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">Layout</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a9b7c6">{</span><span>isLoading </span><span class="token" style="color:#a9b7c6">?</span><span> </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">LoadingSpinner</span><span> </span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span> </span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token null nil" style="color:#cc7832">null</span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>      </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">Component</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span class="token spread" style="color:#a9b7c6">...</span><span>pageProps</span><span class="token" style="color:#a9b7c6">}</span><span> </span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span class="token maybe-class-name">Layout</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span class="token maybe-class-name">Mobile</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">Desktop</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">CannotDesktop</span><span> </span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span class="token maybe-class-name">Desktop</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span class="token" style="color:#a9b7c6">;</span></code></pre></pre>
<p>똑같은 코드로 리액트 코드에 적용할 때는 문제가 없었지만, Nextjs를 이용한 이번 상황의 경우 Hydration 에러가 발생했다.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbjYUXg%2FbtrTRCeaovE%2FwQr4OZdJectnkkG06XmTEk%2Fimg.png" alt="image"/></p>
<p>vercel로 배포할 때는 정상적으로 빌드되기는 했지만</p>
<p>로컬에서 작업할때 지속적으로 발생하는 오류 메세지 창이 불편하기도 하여 바로 처리해봤다.</p>
<blockquote>
<p>Hydration failed because the initial UI does not match what was rendered on the server</p>
</blockquote>
<p>초기 UI가 서버에서 렌더링된 것과 일치하지 않는다고 한다.</p>
<p><a href="https://nextjs.org/docs/messages/react-hydration-error">https://nextjs.org/docs/messages/react-hydration-error</a></p>
<p>공식 페이지를 보면 &quot;애플리케이션을 렌더링하는 동안 미리 렌더링된 React 트리(SSR/SSG)와 브라우저에서 첫 번째 렌더링 중에 렌더링된 React 트리 간에 차이가 있었기 때문에 발생한 오류&quot;라고 한다.</p>
<p>일반적으로 이 문제는 사전 렌더링과 브라우저 간에 다를 수 있는 항목에 의존하는 특정 라리브러리 또는 애플리케이션 코드를 사용하여 발생한다고 하는데,</p>
<p>나의 경우, react-responsive에 의한 경우였다.</p>
<h2>코드 수정</h2>
<pre><pre node="[object Object]" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-typescript" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// useMideaQuery.tsx</span><span>
</span>
<span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports" style="color:#a9b7c6">{</span><span class="token imports"> useEffect</span><span class="token imports" style="color:#a9b7c6">,</span><span class="token imports"> useState </span><span class="token imports" style="color:#a9b7c6">}</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&quot;react&quot;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports" style="color:#a9b7c6">{</span><span class="token imports"> useMediaQuery </span><span class="token imports" style="color:#a9b7c6">}</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&quot;react-responsive&quot;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span>
<span></span><span class="token module" style="color:#cc7832">export</span><span> </span><span class="token" style="color:#cc7832">const</span><span> </span><span class="token function-variable maybe-class-name" style="color:#ffc66d">Mobile</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>  </span><span class="token" style="color:#cc7832">const</span><span> </span><span class="token" style="color:#a9b7c6">[</span><span>mobile</span><span class="token" style="color:#a9b7c6">,</span><span> setMobile</span><span class="token" style="color:#a9b7c6">]</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token generic-function" style="color:#ffc66d">useState</span><span class="token generic-function generic class-name" style="color:#a9b7c6">&lt;</span><span class="token generic-function generic class-name" style="color:#e8bf6a">boolean</span><span class="token generic-function generic class-name" style="color:#a9b7c6">&gt;</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">false</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>  </span><span class="token" style="color:#cc7832">const</span><span> isMobile </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#ffc66d">useMediaQuery</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">{</span><span> maxWidth</span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token" style="color:#6897bb">480</span><span> </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span>
<span>  </span><span class="token" style="color:#cc7832">const</span><span> </span><span class="token function-variable" style="color:#ffc66d">checkResize</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#cc7832">if</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span>isMobile</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>      </span><span class="token" style="color:#ffc66d">setMobile</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">true</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">}</span><span> </span><span class="token control-flow" style="color:#cc7832">else</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>      </span><span class="token" style="color:#ffc66d">setMobile</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">false</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span><span>
</span>
<span>  </span><span class="token" style="color:#ffc66d">useEffect</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>    </span><span class="token" style="color:#ffc66d">checkResize</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#a9b7c6">[</span><span>isMobile</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span>
<span>  </span><span class="token control-flow" style="color:#cc7832">return</span><span> mobile</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token" style="color:#808080">//_app.tsx</span><span>
</span>
<span></span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">RecoilRoot</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">{</span><span>isMobile </span><span class="token" style="color:#a9b7c6">?</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">Layout</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a9b7c6">{</span><span>isLoading </span><span class="token" style="color:#a9b7c6">?</span><span> </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">LoadingSpinner</span><span> </span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span> </span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token null nil" style="color:#cc7832">null</span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>      </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">Component</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span class="token spread" style="color:#a9b7c6">...</span><span>pageProps</span><span class="token" style="color:#a9b7c6">}</span><span> </span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span class="token maybe-class-name">Layout</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token maybe-class-name">CannotDesktop</span><span> </span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span class="token maybe-class-name">RecoilRoot</span><span class="token" style="color:#a9b7c6">&gt;</span><span class="token" style="color:#a9b7c6">;</span></code></pre></pre>
<p>useMideaQuery가 window 화면을 기준으로 동작하기 때문에,</p>
<p>공식문서의 예제와 비슷하게 useState를 통한 boolean 값으로 화면을 노출시켜줬다.</p>
<p>위의 방식을 적용하니 hydration 에러 없이 잘 작동하는 모습을 볼 수 있었다.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdH0CZg%2FbtrTRp0izJZ%2FiolwpQXLvGOommEBhpCkaK%2Fimg.png" alt="image"/></p></div></main><div class="sc-cf73707f-0 kQQEbP"><p><strong>&quot;nextjs&quot;</strong> <!-- -->카테고리의 다른 글</p><ul class="sc-cf73707f-1 hpUmIG"></ul></div><div class="sc-b1521f6d-3 gCoGbC"><p>COMMENTS</p><section id="comment-box"></section></div></main></article><aside class="sc-a8eb4d0-0 hPXHcC"><nav class="sc-ca204857-0 eNWXGi"><ul class="sc-ca204857-1 Jmuhj"><li>Category</li><li class="sc-ca204857-2 SRJNA"><a href="/github">Simple Memo</a></li><li class="sc-ca204857-2 SRJNA"><a href="/html">HTML</a></li><li class="sc-ca204857-2 SRJNA"><a href="/css">CSS</a></li><li class="sc-ca204857-2 SRJNA"><a href="/javascript">JavaScript</a></li><li class="sc-ca204857-2 SRJNA"><a href="/typescript">TypeScript</a></li><li class="sc-ca204857-2 SRJNA"><a href="/redux">Redux</a></li><li class="sc-ca204857-2 SRJNA"><a href="/react">React</a></li><li style="color:white;font-weight:bold" class="sc-ca204857-2 SRJNA"><a href="/nextjs">Nextjs</a></li><li class="sc-ca204857-2 SRJNA"><a href="/nestjs">Nestjs</a></li></ul></nav></aside></section></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"nextjs react responsive","description":"nextjs에 react responsive 적용하기","category":"nextjs","date":"2023-03-04","content":"\r\n### 이번에 새로 만들고 있는 토이 프로젝트를 작업하던 중, 모바일 화면일때만 화면을 보여주고 싶었다. 단, 모든 컴포넌트에 미디어쿼리를 통해 작성해줄 수는 없기에 react-responsive를 적용해 화면이 481px을 넘어가면 고정된 페이지를 보여줄 수 있도록 코드를 작성했다.\r\n\r\n## react-responsive 설치\r\n\r\n```bash\r\nyarn add react-responsive\r\n```\r\n\r\n## hook 설정\r\n\r\n```typescript\r\n// hook\r\n// useMideaQuery.tsx\r\nexport const Desktop = ({ children }: any) =\u003e {\r\n  const isDesktop = useMediaQuery({\r\n    minWidth: 481,\r\n  });\r\n  return isDesktop ? children : null;\r\n};\r\n\r\nexport const Mobile = ({ children }: any) =\u003e {\r\n  const isMobile = useMediaQuery({\r\n    minWidth: 481,\r\n  });\r\n  return Mobile ? children : null;\r\n};\r\n```\r\n\r\n## \\_app.ts 적용\r\n\r\n```typescript\r\n// _app.tsx\r\n\r\n// ...\r\nimport { Mobile } from \"src/hooks/useMideaQuery\";\r\nimport { CannotDesktop } from \"src/desktop/CannotDesktop\";\r\n\r\n\u003c\u003e\r\n  \u003cMobile\u003e\r\n    \u003cLayout\u003e\r\n      {isLoading ? \u003cLoadingSpinner /\u003e : null}\r\n      \u003cComponent {...pageProps} /\u003e\r\n    \u003c/Layout\u003e\r\n  \u003c/Mobile\u003e\r\n  \u003cDesktop\u003e\r\n    \u003cCannotDesktop /\u003e\r\n  \u003c/Desktop\u003e\r\n\u003c/\u003e;\r\n```\r\n\r\n똑같은 코드로 리액트 코드에 적용할 때는 문제가 없었지만, Nextjs를 이용한 이번 상황의 경우 Hydration 에러가 발생했다.\r\n\r\n![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbjYUXg%2FbtrTRCeaovE%2FwQr4OZdJectnkkG06XmTEk%2Fimg.png)\r\n\r\nvercel로 배포할 때는 정상적으로 빌드되기는 했지만\r\n\r\n로컬에서 작업할때 지속적으로 발생하는 오류 메세지 창이 불편하기도 하여 바로 처리해봤다.\r\n\r\n\u003e Hydration failed because the initial UI does not match what was rendered on the server\r\n\r\n초기 UI가 서버에서 렌더링된 것과 일치하지 않는다고 한다.\r\n\r\nhttps://nextjs.org/docs/messages/react-hydration-error\r\n\r\n공식 페이지를 보면 \"애플리케이션을 렌더링하는 동안 미리 렌더링된 React 트리(SSR/SSG)와 브라우저에서 첫 번째 렌더링 중에 렌더링된 React 트리 간에 차이가 있었기 때문에 발생한 오류\"라고 한다.\r\n\r\n일반적으로 이 문제는 사전 렌더링과 브라우저 간에 다를 수 있는 항목에 의존하는 특정 라리브러리 또는 애플리케이션 코드를 사용하여 발생한다고 하는데,\r\n\r\n나의 경우, react-responsive에 의한 경우였다.\r\n\r\n## 코드 수정\r\n\r\n```typescript\r\n// useMideaQuery.tsx\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\n\r\nexport const Mobile = () =\u003e {\r\n  const [mobile, setMobile] = useState\u003cboolean\u003e(false);\r\n  const isMobile = useMediaQuery({ maxWidth: 480 });\r\n\r\n  const checkResize = () =\u003e {\r\n    if (isMobile) {\r\n      setMobile(true);\r\n    } else {\r\n      setMobile(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() =\u003e {\r\n    checkResize();\r\n  }, [isMobile]);\r\n\r\n  return mobile;\r\n};\r\n//_app.tsx\r\n\r\n\u003cRecoilRoot\u003e\r\n  {isMobile ? (\r\n    \u003cLayout\u003e\r\n      {isLoading ? \u003cLoadingSpinner /\u003e : null}\r\n      \u003cComponent {...pageProps} /\u003e\r\n    \u003c/Layout\u003e\r\n  ) : (\r\n    \u003cCannotDesktop /\u003e\r\n  )}\r\n\u003c/RecoilRoot\u003e;\r\n```\r\n\r\nuseMideaQuery가 window 화면을 기준으로 동작하기 때문에,\r\n\r\n공식문서의 예제와 비슷하게 useState를 통한 boolean 값으로 화면을 노출시켜줬다.\r\n\r\n위의 방식을 적용하니 hydration 에러 없이 잘 작동하는 모습을 볼 수 있었다.\r\n\r\n![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdH0CZg%2FbtrTRp0izJZ%2FiolwpQXLvGOommEBhpCkaK%2Fimg.png)\r\n"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"nextjs-react-responsive"},"buildId":"QopKNQVYuIv1AsUZhOp4w","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>