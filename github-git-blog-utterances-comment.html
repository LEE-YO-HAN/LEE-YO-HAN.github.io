<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Rain Sugar BangBang Front-End</title><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="utterances를 이용한 Nextjs Github 블로그 댓글 기능 구현"/><meta name="keywords" content="github, github git blog utterances comment"/><meta http-equiv="title" content="utterances를 이용한 Nextjs Github 블로그 댓글 기능 구현"/><meta http-equiv="subject" content="github"/><meta property="og:title" content="github git blog utterances comment"/><meta property="og:description" content="utterances를 이용한 Nextjs Github 블로그 댓글 기능 구현"/><meta property="og:image" content="/images/cards/GITHUB.png"/><meta name="naver-site-verification" content="af9c8049662a7c6c85ea946e9eb561086e70062c"/><meta name="google-site-verification" content="Zgp7rA3RAdcRnhPPsGLK-t4KVTO86AejlDIQQIGpvLg"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4077287316160146" crossorigin="anonymous"></script><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="14"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/f9bc783e634631d2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f9bc783e634631d2.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-7d0bddee48749f95.js" defer=""></script><script src="/_next/static/chunks/framework-73b8966a3c579ab0.js" defer=""></script><script src="/_next/static/chunks/main-b0c8bcfd40968c52.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8e74bf16f11e69be.js" defer=""></script><script src="/_next/static/chunks/224-d3df8d854690f2a0.js" defer=""></script><script src="/_next/static/chunks/572-85f46fe0d367792d.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-1e53f6a91eb0ff2f.js" defer=""></script><script src="/_next/static/DzsCfRaYxHxCOFlU5gjlQ/_buildManifest.js" defer=""></script><script src="/_next/static/DzsCfRaYxHxCOFlU5gjlQ/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="sc-c845a976-0 icUnkm"><header class="sc-4bf6e269-0 eOrcva"><h1><a href="/">Rain Sugar BangBang</a></h1></header><section class="sc-c845a976-1 bePtAz"><aside class="sc-8da54c0a-0 bjetgu"><div class="sc-8da54c0a-1 dIjcTQ"><a href="/profile"><img alt="profile" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" style="color:transparent" src="/images/profileImage/cat.png"/><span>Go Profile!</span></a><p>Hanbbi</p></div><div class="sc-8da54c0a-2 kCIPRs"><a target="_blank" href="https://github.com/LEE-YO-HAN"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0 0 68.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"></path></svg><span>yhl0078@gmail.com</span></a><a target="_blank" href="https://github.com/LEE-YO-HAN"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg><span>Github</span></a></div></aside><article class="sc-c845a976-2 jRRSKe"><main class="sc-e9ba6bf1-0 cAjCIB"><section class="sc-e9ba6bf1-1 eQOsDg"><p>github</p><h1>utterances를 이용한 Nextjs Github 블로그 댓글 기능 구현</h1><span>2023-03-14</span></section><main class="sc-e9ba6bf1-2 dkijLv"><div class="markdown"><h1>utterances란?</h1>
<blockquote>
<p>Github repository의 이슈 기능을 활용해 내 웹사이트에 댓글 기능을 추가할 수 있는 도구로, 별도의 백엔드 구성을 하지 않고 댓글들을 관리할 수 있다는 장점이 있다.</p>
</blockquote>
<p>많이 비교되는 disqus라는 툴도 있다. 하지만, disqus는 댓글 작성을 누구나 할 수 있다는 장점이 있는 반면에 광고가 많다는 단점이 있다.
그에 비해 utterances는 Github 계정 소유자만 댓글을 작성할 수 있지만, 별도의 광고도 없고 댓글 작성 시 Markdown을 지원한다는 특징이 있다.</p>
<p>나는 utterances를 Github blog에 사용할 생각이기에 굳이 utterances의 장점을 버리고 disqus를 사용할 이유가 없었다.</p>
<h1>사용방법</h1>
<h2>1. repository 생성</h2>
<p>public으로 설정된 새 레포가 필요하다.</p>
<p>Github blog repo에 연동해도 상관은 없지만 댓글만을 위한 저장소를 만들어 놓는게 관리가 훨씬 쉬울 것 같아 새 repo를 생성해줬다.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fbq4F8z%2Fbtr34VuvScp%2FwmTQX2iIjKtMjlowowHw80%2Fimg.png" alt="image"/></p>
<p>저장소 이름은 상관 없다.</p>
<h2>2. utterances 설치</h2>
<p>Github app에서 설치할 수 있다.</p>
<p><a href="https://github.com/apps/utterances">https://github.com/apps/utterances</a></p>
<h2>3. utterances access 설정</h2>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FPS87y%2Fbtr35bYlHCH%2FhE9akcKFM7qYE6yAfvKD4k%2Fimg.png" alt="image"/></p>
<p>app이 설치되면 Configure를 통해 어떤 저장소에 연동해줄지 설정할 수 있다.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2F55bSC%2Fbtr37BBZd9Y%2FfSwpH2VCQKwXKpQkXAbO00%2Fimg.png" alt="image"/></p>
<p>나는 선택한 저장소에만 연동되게 설정했다.</p>
<h2>4. utterances.json 생성</h2>
<pre><pre node="[object Object]" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-javascript" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>  </span><span class="token string-property" style="color:#9876aa">&quot;origins&quot;</span><span class="token" style="color:#a9b7c6">:</span><span> </span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&quot;https://{my url}&quot;</span><span class="token" style="color:#a9b7c6">]</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">}</span></code></pre></pre>
<p>위와 같이 자신이 댓글 기능을 사용할 사이트를 utterances.json에 입력해준다.</p>
<h2>5. script를 블로그 repo code에 복사</h2>
<p><a href="https://utteranc.es/?installation_id=35005881&amp;setup_action=install">https://utteranc.es/?installation_id=35005881&amp;setup_action=install</a></p>
<p>해당 사이트에 들어가면 어떤 방식으로 script를 구성할지 설정할 수 있다.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fo9X4N%2Fbtr34VVyI7q%2F2PbuKqgkmKDtfogCNj7Nx0%2Fimg.png" alt="image"/></p>
<blockquote>
<p>Issue mapping같은 경우, 댓글과 포스팅을 어떻게 연동할지 설정하는 것인데, 통상적으로 pathname이나 URL을 많이 사용하지만 본인 프로젝트의 상황에 맞춰 설정해주는 것이 가장 좋다.</p>
</blockquote>
<blockquote>
<p>또한 한글 파일명을 사용해 URL이나 pathname을 생성하는 경우, 유니코드 인식 문제로 비정상적인 URL이 생성될 수 있기 때문에 설정에 유의해야 한다.</p>
</blockquote>
<pre><pre node="[object Object]" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-javascript" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// 복사할 스크립트</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">&lt;</span><span>script
</span><span>  src</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&quot;https://utteranc.es/client.js&quot;</span><span>
</span><span>  repo</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&quot;name/repositoey&quot;</span><span> </span><span class="token" style="color:#808080">// utterances를 연동한 repo 이름</span><span>
</span><span>  issue</span><span class="token" style="color:#a9b7c6">-</span><span>term</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&quot;pathname&quot;</span><span> </span><span class="token" style="color:#808080">// issue mapping</span><span>
</span><span>  theme</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&quot;github-light&quot;</span><span> </span><span class="token" style="color:#808080">// 테마 색상</span><span>
</span><span>  crossorigin</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&quot;anonymous&quot;</span><span>
</span>  async
<span></span><span class="token" style="color:#a9b7c6">&gt;</span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#a9b7c6">/</span><span>script</span><span class="token" style="color:#a9b7c6">&gt;</span></code></pre></pre>
<p>테마 색상도 다양하기 때문에 utterances 사이트에서 원하는 색상을 골라가며 설정해줘도 괜찮다.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FxYtiI%2Fbtr35FEVVmk%2FcS0dxRjlWfFukRPCaL9y61%2Fimg.png" alt="image"/></p>
<p>위에 생성한 script는 통상적으로 댓글 부분에 해당되는 곳에 그대로 복사해 넣지만, 나는 Nextjs를 통해 댓글 컴포넌트를 생성할 것이기 때문에 다른 방식을 사용했다.</p>
<pre><pre node="[object Object]" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-javascript" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#cc7832">export</span><span> </span><span class="token" style="color:#cc7832">const</span><span> </span><span class="token function-variable maybe-class-name" style="color:#ffc66d">Comment</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>  </span><span class="token control-flow" style="color:#cc7832">return</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">&lt;</span><span>section
</span><span>      ref</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#a9b7c6">{</span><span class="token parameter">elem</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#cc7832">if</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">!</span><span>elem</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>          </span><span class="token control-flow" style="color:#cc7832">return</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>        </span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>        </span><span class="token" style="color:#cc7832">const</span><span> scriptElem </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token dom" style="color:#9876aa">document</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">createElement</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;script&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>        scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">src</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#6a8759">&quot;https://utteranc.es/client.js&quot;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>        scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">async</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#cc7832">true</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>        scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">setAttribute</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;repo&quot;</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#6a8759">&quot;{utterances repo name}&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>        scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">setAttribute</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;issue-term&quot;</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#6a8759">&quot;pathname&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>        scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">setAttribute</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;theme&quot;</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#6a8759">&quot;github-dark&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>        scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">setAttribute</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;label&quot;</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#6a8759">&quot;blog-comment&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>        scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">crossOrigin</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#6a8759">&quot;anonymous&quot;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>        elem</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">appendChild</span><span class="token" style="color:#a9b7c6">(</span><span>scriptElem</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>      </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span></code></pre></pre>
<p>해당 컴포넌트에 사용하기 위해 기존의 script와 같은 속성들을 넣어줬다.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fckai9y%2Fbtr4aKSLFRA%2F9p3HEGqDCEkfa8sg7Nnd0k%2Fimg.png" alt="image"/></p>
<p>하지만 strict 모드를 false로 해도 종종 댓글찾이 2개가 되어버려 useEffect를 통해 1번만 script를 붙일 수 있도록 코드를 수정했다.</p>
<pre><pre node="[object Object]" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-javascript" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#cc7832">import</span><span> </span><span class="token imports" style="color:#a9b7c6">{</span><span class="token imports"> useEffect </span><span class="token imports" style="color:#a9b7c6">}</span><span> </span><span class="token module" style="color:#cc7832">from</span><span> </span><span class="token" style="color:#6a8759">&quot;react&quot;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span>
<span></span><span class="token module" style="color:#cc7832">export</span><span> </span><span class="token" style="color:#cc7832">const</span><span> </span><span class="token function-variable maybe-class-name" style="color:#ffc66d">Comment</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>  </span><span class="token" style="color:#cc7832">const</span><span> </span><span class="token function-variable" style="color:#ffc66d">makeRef</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token parameter literal-property" style="color:#9876aa">el</span><span class="token parameter" style="color:#a9b7c6">:</span><span class="token parameter"> </span><span class="token parameter maybe-class-name">HTMLElement</span><span class="token parameter"> </span><span class="token parameter" style="color:#a9b7c6">|</span><span class="token parameter"> </span><span class="token parameter null nil" style="color:#cc7832">null</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#cc7832">if</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">!</span><span>el</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>      </span><span class="token control-flow" style="color:#cc7832">return</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">}</span><span> </span><span class="token control-flow" style="color:#cc7832">else</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>      </span><span class="token" style="color:#cc7832">const</span><span> scriptElem </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token dom" style="color:#9876aa">document</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">createElement</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;script&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>      scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">src</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#6a8759">&quot;https://utteranc.es/client.js&quot;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>      scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">async</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#cc7832">true</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>      scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">setAttribute</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;repo&quot;</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#6a8759">&quot;{utterances repo name}&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>      scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">setAttribute</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;issue-term&quot;</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#6a8759">&quot;pathname&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>      scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">setAttribute</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;theme&quot;</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#6a8759">&quot;github-dark&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>      scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">setAttribute</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;label&quot;</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#6a8759">&quot;blog-comment&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>      scriptElem</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">crossOrigin</span><span> </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token" style="color:#6a8759">&quot;anonymous&quot;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>      el</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">appendChild</span><span class="token" style="color:#a9b7c6">(</span><span>scriptElem</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>    </span><span class="token" style="color:#a9b7c6">}</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span><span>
</span>
<span>  </span><span class="token" style="color:#ffc66d">useEffect</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token arrow" style="color:#a9b7c6">=&gt;</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>    </span><span class="token" style="color:#cc7832">const</span><span> newEl </span><span class="token" style="color:#a9b7c6">=</span><span> </span><span class="token dom" style="color:#9876aa">document</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">getElementById</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;comment-box&quot;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>    </span><span class="token" style="color:#ffc66d">makeRef</span><span class="token" style="color:#a9b7c6">(</span><span>newEl</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span>  </span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">,</span><span> </span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span><span>
</span>
<span>  </span><span class="token control-flow" style="color:#cc7832">return</span><span> </span><span class="token" style="color:#a9b7c6">&lt;</span><span>section id</span><span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&quot;comment-box&quot;</span><span> </span><span class="token" style="color:#a9b7c6">/</span><span class="token" style="color:#a9b7c6">&gt;</span><span class="token" style="color:#a9b7c6">;</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span></code></pre></pre>
<p>코드 수정 후 원하는대로 동작하는 모습을 볼 수 있었다.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcNZNaQ%2Fbtr38NhUPkk%2FSH2Dgj2Si71gH3Gykm9kYK%2Fimg.png" alt="image"/></p></div></main><div class="sc-5d85fe2b-0 hZKBvj"><p><strong>&quot;Simple Memo&quot;</strong> <!-- -->카테고리의 다른 글</p><ul class="sc-5d85fe2b-1 iBEUbA"></ul></div><div class="sc-e9ba6bf1-3 iviOZH"><p>COMMENTS</p><section id="comment-box"></section></div></main></article><aside class="sc-25c0fcf1-0 hVEAVi"><nav class="sc-cd9d196f-0 eIKFyK"><ul class="sc-cd9d196f-1 ljGEKP"><li>Category</li><li class="sc-cd9d196f-2 itBJIo"><a style="color:white;font-weight:bold" href="/github">Simple Memo</a></li><li class="sc-cd9d196f-2 itBJIo"><a href="/html">HTML</a></li><li class="sc-cd9d196f-2 itBJIo"><a href="/css">CSS</a></li><li class="sc-cd9d196f-2 itBJIo"><a href="/javascript">JavaScript</a></li><li class="sc-cd9d196f-2 itBJIo"><a href="/typescript">TypeScript</a></li><li class="sc-cd9d196f-2 itBJIo"><a href="/redux">Redux</a></li><li class="sc-cd9d196f-2 itBJIo"><a href="/react">React</a></li><li class="sc-cd9d196f-2 itBJIo"><a href="/nextjs">Nextjs</a></li><li class="sc-cd9d196f-2 itBJIo"><a href="/nestjs">Nestjs</a></li></ul></nav></aside></section></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"github git blog utterances comment","description":"utterances를 이용한 Nextjs Github 블로그 댓글 기능 구현","category":"github","date":"2023-03-14","content":"\r\n# utterances란?\r\n\r\n\u003e Github repository의 이슈 기능을 활용해 내 웹사이트에 댓글 기능을 추가할 수 있는 도구로, 별도의 백엔드 구성을 하지 않고 댓글들을 관리할 수 있다는 장점이 있다.\r\n\r\n많이 비교되는 disqus라는 툴도 있다. 하지만, disqus는 댓글 작성을 누구나 할 수 있다는 장점이 있는 반면에 광고가 많다는 단점이 있다.\r\n그에 비해 utterances는 Github 계정 소유자만 댓글을 작성할 수 있지만, 별도의 광고도 없고 댓글 작성 시 Markdown을 지원한다는 특징이 있다.\r\n\r\n나는 utterances를 Github blog에 사용할 생각이기에 굳이 utterances의 장점을 버리고 disqus를 사용할 이유가 없었다.\r\n\r\n# 사용방법\r\n\r\n## 1. repository 생성\r\n\r\npublic으로 설정된 새 레포가 필요하다.\r\n\r\nGithub blog repo에 연동해도 상관은 없지만 댓글만을 위한 저장소를 만들어 놓는게 관리가 훨씬 쉬울 것 같아 새 repo를 생성해줬다.\r\n\r\n![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fbq4F8z%2Fbtr34VuvScp%2FwmTQX2iIjKtMjlowowHw80%2Fimg.png)\r\n\r\n저장소 이름은 상관 없다.\r\n\r\n## 2. utterances 설치\r\n\r\nGithub app에서 설치할 수 있다.\r\n\r\nhttps://github.com/apps/utterances\r\n\r\n## 3. utterances access 설정\r\n\r\n![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FPS87y%2Fbtr35bYlHCH%2FhE9akcKFM7qYE6yAfvKD4k%2Fimg.png)\r\n\r\napp이 설치되면 Configure를 통해 어떤 저장소에 연동해줄지 설정할 수 있다.\r\n\r\n![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2F55bSC%2Fbtr37BBZd9Y%2FfSwpH2VCQKwXKpQkXAbO00%2Fimg.png)\r\n\r\n나는 선택한 저장소에만 연동되게 설정했다.\r\n\r\n## 4. utterances.json 생성\r\n\r\n```javascript\r\n{\r\n  \"origins\": [\"https://{my url}\"]\r\n}\r\n```\r\n\r\n위와 같이 자신이 댓글 기능을 사용할 사이트를 utterances.json에 입력해준다.\r\n\r\n## 5. script를 블로그 repo code에 복사\r\n\r\nhttps://utteranc.es/?installation_id=35005881\u0026setup_action=install\r\n\r\n해당 사이트에 들어가면 어떤 방식으로 script를 구성할지 설정할 수 있다.\r\n\r\n![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fo9X4N%2Fbtr34VVyI7q%2F2PbuKqgkmKDtfogCNj7Nx0%2Fimg.png)\r\n\r\n\u003e Issue mapping같은 경우, 댓글과 포스팅을 어떻게 연동할지 설정하는 것인데, 통상적으로 pathname이나 URL을 많이 사용하지만 본인 프로젝트의 상황에 맞춰 설정해주는 것이 가장 좋다.\r\n\r\n\u003e 또한 한글 파일명을 사용해 URL이나 pathname을 생성하는 경우, 유니코드 인식 문제로 비정상적인 URL이 생성될 수 있기 때문에 설정에 유의해야 한다.\r\n\r\n```javascript\r\n// 복사할 스크립트\r\n\u003cscript\r\n  src=\"https://utteranc.es/client.js\"\r\n  repo=\"name/repositoey\" // utterances를 연동한 repo 이름\r\n  issue-term=\"pathname\" // issue mapping\r\n  theme=\"github-light\" // 테마 색상\r\n  crossorigin=\"anonymous\"\r\n  async\r\n\u003e\u003c/script\u003e\r\n```\r\n\r\n테마 색상도 다양하기 때문에 utterances 사이트에서 원하는 색상을 골라가며 설정해줘도 괜찮다.\r\n\r\n![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FxYtiI%2Fbtr35FEVVmk%2FcS0dxRjlWfFukRPCaL9y61%2Fimg.png)\r\n\r\n위에 생성한 script는 통상적으로 댓글 부분에 해당되는 곳에 그대로 복사해 넣지만, 나는 Nextjs를 통해 댓글 컴포넌트를 생성할 것이기 때문에 다른 방식을 사용했다.\r\n\r\n```javascript\r\nexport const Comment = () =\u003e {\r\n  return (\r\n    \u003csection\r\n      ref={elem =\u003e {\r\n        if (!elem) {\r\n          return;\r\n        }\r\n        const scriptElem = document.createElement(\"script\");\r\n        scriptElem.src = \"https://utteranc.es/client.js\";\r\n        scriptElem.async = true;\r\n        scriptElem.setAttribute(\"repo\", \"{utterances repo name}\");\r\n        scriptElem.setAttribute(\"issue-term\", \"pathname\");\r\n        scriptElem.setAttribute(\"theme\", \"github-dark\");\r\n        scriptElem.setAttribute(\"label\", \"blog-comment\");\r\n        scriptElem.crossOrigin = \"anonymous\";\r\n        elem.appendChild(scriptElem);\r\n      }}\r\n    /\u003e\r\n  );\r\n};\r\n```\r\n\r\n해당 컴포넌트에 사용하기 위해 기존의 script와 같은 속성들을 넣어줬다.\r\n\r\n![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fckai9y%2Fbtr4aKSLFRA%2F9p3HEGqDCEkfa8sg7Nnd0k%2Fimg.png)\r\n\r\n하지만 strict 모드를 false로 해도 종종 댓글찾이 2개가 되어버려 useEffect를 통해 1번만 script를 붙일 수 있도록 코드를 수정했다.\r\n\r\n```javascript\r\nimport { useEffect } from \"react\";\r\n\r\nexport const Comment = () =\u003e {\r\n  const makeRef = (el: HTMLElement | null) =\u003e {\r\n    if (!el) {\r\n      return;\r\n    } else {\r\n      const scriptElem = document.createElement(\"script\");\r\n      scriptElem.src = \"https://utteranc.es/client.js\";\r\n      scriptElem.async = true;\r\n      scriptElem.setAttribute(\"repo\", \"{utterances repo name}\");\r\n      scriptElem.setAttribute(\"issue-term\", \"pathname\");\r\n      scriptElem.setAttribute(\"theme\", \"github-dark\");\r\n      scriptElem.setAttribute(\"label\", \"blog-comment\");\r\n      scriptElem.crossOrigin = \"anonymous\";\r\n      el.appendChild(scriptElem);\r\n    }\r\n  };\r\n\r\n  useEffect(() =\u003e {\r\n    const newEl = document.getElementById(\"comment-box\");\r\n    makeRef(newEl);\r\n  }, []);\r\n\r\n  return \u003csection id=\"comment-box\" /\u003e;\r\n};\r\n```\r\n\r\n코드 수정 후 원하는대로 동작하는 모습을 볼 수 있었다.\r\n\r\n![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcNZNaQ%2Fbtr38NhUPkk%2FSH2Dgj2Si71gH3Gykm9kYK%2Fimg.png)\r\n"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"github-git-blog-utterances-comment"},"buildId":"DzsCfRaYxHxCOFlU5gjlQ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>